<img src="{{imgPath}}{{movie()?.poster_path}}" alt="Portada de {{movie()?.title}}" class="poster">
<h1>{{movie()?.title}}</h1>
<h2>{{movie()?.tagline}}</h2>
<h3>{{((movie()?.vote_average || 0) * 10).toFixed(0)}}%</h3>
<span>{{movie()?.release_date | date:'dd-MM-yyyy'}}</span>
<span>
    @for (genre of movie()?.genres; track $index) {
        @if ($index > 0) {,} {{genre.name}}
    }
</span>
<span>{{movie()?.runtime}} minutos</span>
<p>{{movie()?.overview}}</p>

<h2>Reparto</h2>
<p>
    @for (c of movie()?.credits?.cast; track $index) {
        <button type="button">
            <!-- TODO imagen vacia para quien no tiene foto -->
             @if(!c.profile_path){
                 <img src="/no-photo.svg" alt="Portada de {{c.name}}" width="100px">
             }@else{
                 <img src="{{imgPath}}{{c.profile_path}}" alt="Portada de {{c.name}}" width="100px">
             }
            <p><span>{{c.character}}</span><br>{{c.name}}</p>
        </button>
    }
</p>

<h2>Películas Similares</h2>
    @for (s of movie()?.similar?.results; track $index) {
        <button type="button" (click)="showMovieDetails(s.id)">
            <img src="{{imgPath}}{{s.poster_path}}" alt="Portada de {{s.title}}" width="100px">
        </button>
    }

<h2>Películas Recomendadas</h2>
    @for (r of movie()?.recommendations?.results; track $index) {
        <button type="button" (click)="showMovieDetails(r.id)">
            <img src="{{imgPath}}{{r.poster_path}}" alt="Portada de {{r.title}}" width="100px">
        </button>
    }

<!-- TODO: crear un componente con la lista de peliculas de home y reutilizarlo aquí -->
<section class="card-list">
    @for (movie of movie()?.recommendations?.results; track $index) {
        <mat-card class="card" appearance="outlined" (click)="showMovieDetails(movie.id)">
            <img mat-card-image src="{{imgPath}}{{movie.poster_path}}" alt="poster de {{movie.title}}">
            <div class="movie-average-circle">
                <mat-spinner mode="determinate" value="{{(movie.vote_average * 10).toFixed(0)}}" class="movie-average-spinner"></mat-spinner>
                <span class="average-number">{{(movie.vote_average * 10).toFixed(0)}}</span><span class="average-percent">%</span>
            </div>
            <mat-card-title-group class="card-title-group">
                <mat-card-title class="card-title">{{movie.title}}</mat-card-title>
                <mat-card-subtitle class="card-subtitle">{{movie.release_date | date:'dd-MM-yyyy'}}</mat-card-subtitle>
            </mat-card-title-group> 
        </mat-card>
    }
</section>
